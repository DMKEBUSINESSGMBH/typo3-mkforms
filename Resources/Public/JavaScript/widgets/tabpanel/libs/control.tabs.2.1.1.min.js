/**
 * @author Ryan Johnson <ryan@livepipe.net>
 * @copyright 2007 LivePipe LLC
 * @package Control.Tabs
 * @license MIT
 * @url http://livepipe.net/projects/control_tabs/
 * @version 2.1.1
 */
if(void 0===Control)var Control={};Control.Tabs=Base.extend({constructor:function(t,i){if(MKWrapper.$(t)){this.activeContainer=!1,this.activeLink=!1,this.containers={},this.links=[],Control.Tabs.instances.push(this),this.options={beforeChange:function(){},afterChange:function(){},hover:!1,linkSelector:"li a",setClassOnContainer:!1,activeClassName:"active",defaultTab:"first",autoLinkExternal:!0,targetRegExp:/#(.+)$/,showFunction:MKWrapper.fxAppear,hideFunction:MKWrapper.fxHide},MKWrapper.extend(this.options,i||{});var n="string"==typeof this.options.linkSelector?MKWrapper.findChilds(MKWrapper.$(t),this.options.linkSelector):this.options.linkSelector(MKWrapper.$(t));MKWrapper.each(MKWrapper.filter(n,function(t){return/^#/.exec(t.href.replace(window.location.href.split("#")[0],""))}),function(t){this.addTab(t)}.bind(this)),MKWrapper.each(Formidable.objValues(this.containers),this.options.hideFunction),"first"==this.options.defaultTab?this.setActiveTab(this.links[0]):"last"==this.options.defaultTab?this.setActiveTab(this.links[this.links.length-1]):"none"!=this.options.defaultTab&&this.setActiveTab(this.options.defaultTab);var e=this.options.targetRegExp.exec(window.location);e&&e[1]&&MKWrapper.each(e[1].split(","),function(t){MKWrapper.each(this.links,function(t,i){if(i.key==t)return this.setActiveTab(i),!1}.bind(this,t))}.bind(this)),this.options.autoLinkExternal&&MKWrapper.each(document.getElementsByTagName("a"),function(t){if(!MKWrapper.inArray(t,this.links)){var i=t.href.replace(window.location.href.split("#")[0],"");"#"==i.substring(0,1)&&this.containers[i.substring(1)]&&MKWrapper.attachEvent(MKWrapper.$(t),"click",function(t){this.setActiveTab(i.substring(1))},this)}}.bind(this))}},addTab:function(t){var i=this;this.links.push(t);var n=t.getAttribute("href").split("#");t.key=n[n.length-1],this.containers[t.key]=MKWrapper.$(t.key),MKWrapper.attachEvent(MKWrapper.$(t),this.options.hover?"mouseover":"click",function(n){return MKWrapper.stopEvent(n),i.setActiveTab(t),!1},this)},setActiveTab:function(t){t&&("string"==typeof t?MKWrapper.each(this.links,function(i){if(i.key==t)return this.setActiveTab(i),!1}.bind(this)):(this.notify("beforeChange",this.activeContainer),this.activeContainer&&this.options.hideFunction(this.activeContainer),MKWrapper.each(this.links,function(t){MKWrapper.removeClass(this.options.setClassOnContainer?MKWrapper.$(t.parentNode):t,this.options.activeClassName)}.bind(this)),MKWrapper.addClass(this.options.setClassOnContainer?MKWrapper.$(t.parentNode):t,this.options.activeClassName),this.activeContainer=this.containers[t.key],this.activeLink=t,this.options.showFunction(this.containers[t.key]),this.notify("afterChange",this.containers[t.key])))},next:function(){var t=!1;return MKWrapper.each(this.links,function(i,n){this.activeLink==i&&this.links[n+1]&&(t=this.links[n+1])}.bind(this)),this.setActiveTab(t),!1},previous:function(){return MKWrapper.each(this.links,function(t,i){this.activeLink==t&&this.links[i-1]&&this.setActiveTab(this.links[i-1])}.bind(this)),!1},first:function(){return this.setActiveTab(this.links.first()),!1},last:function(){return this.setActiveTab(this.links.last()),!1},notify:function(t){try{if(this.options[t])return[this.options[t].apply(this.options[t],Array.from(arguments).slice(1))]}catch(t){return!1}}}),MKWrapper.extend(Control.Tabs,{instances:[],findByTabId:function(t){return Control.Tabs.instances.find(function(i){return i.links.find(function(i){return i.key==t})})}});
